# -*- coding: utf-8 -*-
"""train-nlp-model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/github/marshmellow77/nlp-model-shakespeare/blob/main/train-nlp-model.ipynb
"""

!git clone https://github.com/huggingface/transformers

!python transformers/examples/pytorch/language-modeling/run_clm.py \
    --model_name_or_path distilgpt2 \
    --dataset_name tiny_shakespeare \
    --do_train \
    --do_eval \
    --output_dir shakespeare-clm \
    --per_device_train_batch_size 2 \
    --per_device_eval_batch_size 2

from transformers import pipeline

textgen_untrained = pipeline("text-generation", model="distilgpt2")

print(textgen_untrained("The meaning of life", min_length=50, max_length=100)[0]['generated_text'])

textgen_shakespeare = pipeline("text-generation", "./shakespeare-clm")

print(textgen_shakespeare("The meaning of life", min_length=50, max_length=100)[0]['generated_text'])

